# Техническое задание: Веб-интерфейс "Министерство Решения Проблем"

## 1. Общее описание
Необходимо разработать веб-интерфейс (SPA) на базе Next.js, который заменит консольный клиент (`client.py`) для взаимодействия с API сервиса "Министерство Решения Проблем". Приложение должно предоставлять пользователю пошаговый процесс: от описания проблемы до получения вердикта "Министра", скрывая технические детали взаимодействия с бэкендом.

**Целевая аудитория**: Пользователи, ищущие решение своих проблем в игровой/серьезной форме.

## 2. Технологический стек
*   **Фреймворк**: Next.js (App Router).
*   **Стилизация**: Tailwind CSS.
*   **API Клиент**: Встроенные API Routes (Next.js) как прокси к основному Python-сервису (`http://localhost:8080`).
*   **Отображение текста**: `react-markdown` (для рендеринга вопросов, анализа и решений, приходящих в Markdown).
*   **Шрифты**: Крупные, читабельные (Google Inter или Merriweather для заголовков).
*   **Иконки**: Lucide React.

## 3. Дизайн и UX
*   **Стилистика**: "Светлая", "воздушная", минималистичная.
*   **Особенности**:
    *   Очень крупные шрифты (заголовки 2rem+, основной текст 1.25rem+).
    *   Мягкие тени, скругленные углы (modern clean UI).
    *   Анимации появления текста и переходов между шагами (framer-motion).
    *   Отсутствие лишних элементов управления — фокус на текущем вопросе/действии.

## 4. Сценарий использования и экраны

Приложение работает как единый пошаговый мастер (Wizard). Состояние сессии хранится в браузере (или в URL), но проксируется через Next.js backend.

### Этап 1: Приемная (Главная страница)
*   **Элементы**:
    *   Заголовок "Министерство Решения Проблем".
    *   Крупное поле ввода (textarea) "Опишите вашу проблему".
    *   Большая кнопка "Подать обращение" (Начать).
*   **Действие**: Отправка `POST /api/init-session` -> Вызов `POST /sessions` на бэкенде.

### Этап 2: Бюрократия (Генерация формы)
*   **Состояние**: Экран загрузки с текстом "Генерация формы обращения...".
*   **Логика**:
    *   Фоновый вызов `POST /api/generate-form`.
    *   Получение JSON с markdown-формой.
    *   (Опционально) Показ сгенерированной формы пользователю на 3-5 секунд с анимацией "Печать..." или кнопкой "Подтвердить и пройти интервью".

### Этап 3: Интервью (Цикл вопросов)
*   **Элементы**:
    *   Отображение текущего вопроса (Markdown).
    *   Поле ввода ответа.
    *   Кнопка "Ответить".
*   **Логика**:
    *   Первый запрос отправляет "Начать" (скрыто от пользователя).
    *   Цикл: Отображение вопроса -> Ввод -> Отправка -> Получение следующего вопроса.
    *   Индикация "Собеседник пишет..." при ожидании ответа API.
    *   При получении флага `is_complete: true` -> переход к Этапу 4.

### Этап 4: Консилиум (Анализ)
*   **Состояние**: Экран ожидания (30-60 секунд).
*   **Визуал**:
    *   Прогресс-бар или спиннер с меняющимися статусами: "Психолог изучает дело...", "Юрист ищет прецеденты...", "Философ размышляет о бытии...".
*   **Действие**: Вызов `POST /api/analyze`.

### Этап 5: Вердикт (Результаты)
*   **Структура**: Длинный скролл или Табы.
*   **Блок 1: Мнения специалистов**. 5 карточек или вкладок (Психолог, Циник, Скептик, Юрист, Философ). Контент — Markdown.
*   **Блок 2: Решение Министра**. Выделенный блок внизу (или модальное окно/отдельный экран) с финальным решением (Markdown). Получается методом `POST /api/decision`.
*   **Футер**: Кнопка "Начать новую сессию".

## 5. Требования к API (BFF Layer - Next.js)

Next.js должен скрыть прямой доступ к `localhost:8080` (избежание CORS проблем и сокрытие архитектуры).

| Метод Next.js | Метод Python Service | Описание |
| :--- | :--- | :--- |
| `POST /api/session/start` | `POST /sessions` | Создает сессию, возвращает `session_id`. |
| `POST /api/session/form` | `POST /sessions/{id}/form` | Генерирует форму. |
| `POST /api/session/interview` | `POST /sessions/{id}/interview` | Отправляет ответ, возвращает вопрос. |
| `POST /api/session/analyze` | `POST /sessions/{id}/analyze` | Запускает анализ. |
| `POST /api/session/decision` | `POST /sessions/{id}/decision` | Получает решение. |

## 6. Технические требования к реализации
1.  **Markdown**: Использовать плагин `typography` в Tailwind для красивого отображения Markdown контента (`prose prose-lg`).
2.  **Обработка ошибок**: Красивые сообщения об ошибках (например, "Министерство временно закрыто на обед"), если бэкенд недоступен.
3.  **Адаптивность**: Корректное отображение на мобильных устройствах.
